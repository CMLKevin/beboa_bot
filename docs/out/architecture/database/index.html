<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/443896d591e4f761-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/e4af272ccee01ff0-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="/_next/static/css/3cf59f0fd0496c15.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-e5714bf66625afb9.js"/><script src="/_next/static/chunks/fd9d1056-e1b8fc02af805f43.js" async=""></script><script src="/_next/static/chunks/117-bf803eaaef7a29e0.js" async=""></script><script src="/_next/static/chunks/main-app-b6379442ececfbb8.js" async=""></script><script src="/_next/static/chunks/972-68a674eeca97bbbb.js" async=""></script><script src="/_next/static/chunks/646-1e67c3e800eb58dd.js" async=""></script><script src="/_next/static/chunks/app/layout-4b75b78215e64ea2.js" async=""></script><script src="/_next/static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js" async=""></script><title>Database Schema - Beboa Docs</title><meta name="description" content="Complete SQLite database schema and table documentation."/><link rel="icon" href="/favicon.ico"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__variable_f367f3 __variable_a06722 font-sans"><div style="visibility:hidden"><div class="min-h-screen bg-[var(--bg-primary)] transition-colors duration-200"><header class="sticky top-0 z-40 w-full h-[var(--header-height)] bg-[var(--bg-secondary)] border-b border-[var(--border)]"><div class="flex items-center justify-between h-full px-4 lg:px-6"><div class="flex items-center gap-6"><button class="lg:hidden p-2 -ml-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors" aria-label="Open menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu w-5 h-5"><line x1="4" x2="20" y1="12" y2="12"></line><line x1="4" x2="20" y1="6" y2="6"></line><line x1="4" x2="20" y1="18" y2="18"></line></svg></button><a class="flex items-center gap-2 text-lg font-semibold text-[var(--text-primary)] hover:text-[var(--accent)] transition-colors" href="/"><span class="text-xl">üêç</span><span class="hidden sm:inline">Beboa</span><span class="hidden sm:inline text-xs font-normal text-[var(--text-muted)] ml-1">Docs</span></a><nav class="hidden lg:flex items-center gap-1"><a class="px-3 py-2 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/">User Guide</a><a class="px-3 py-2 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/">AI Systems</a><a class="px-3 py-2 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/jarvis/">Jarvis Mode</a><a class="px-3 py-2 text-sm font-medium rounded-md transition-colors text-[var(--accent)] bg-[var(--accent-light)]" href="/architecture/structure/">Reference</a></nav></div><div class="flex items-center gap-3"><div class="hidden sm:block"><button class="flex items-center gap-2 px-3 py-2 text-sm text-[var(--text-muted)] bg-[var(--bg-tertiary)] hover:bg-[var(--border)] rounded-lg border border-[var(--border)] transition-colors w-full max-w-[240px]"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-search w-4 h-4"><circle cx="11" cy="11" r="8"></circle><path d="m21 21-4.3-4.3"></path></svg><span class="flex-1 text-left">Search docs...</span><kbd class="hidden sm:inline-flex items-center gap-0.5 px-1.5 py-0.5 text-xs font-medium text-[var(--text-muted)] bg-[var(--bg-secondary)] rounded border border-[var(--border)]"><span class="text-xs">‚åò</span>K</kbd></button></div><button class="sm:hidden p-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors" aria-label="Search"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg></button><a href="https://github.com/CMLKevin/beboa_evo" target="_blank" rel="noopener noreferrer" class="hidden sm:flex p-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github w-5 h-5"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg></a><button class="p-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors" aria-label="Switch to dark mode"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-moon w-5 h-5"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg></button></div></div></header><aside class="fixed inset-y-0 left-0 z-50 w-72 bg-[var(--bg-secondary)] border-r border-[var(--border)] transform transition-transform duration-300 ease-in-out lg:hidden -translate-x-full"><div class="flex items-center justify-between h-[var(--header-height)] px-4 border-b border-[var(--border)]"><a class="flex items-center gap-2 text-lg font-semibold text-[var(--text-primary)]" href="/"><span class="text-xl">üêç</span><span>Beboa</span></a><button class="p-2 -mr-2 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors" aria-label="Close menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-x w-5 h-5"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg></button></div><div class="p-4 border-b border-[var(--border)]"><div class="flex flex-wrap gap-2"><a class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] bg-[var(--bg-tertiary)]" href="/">User Guide</a><a class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] bg-[var(--bg-tertiary)]" href="/ai/">AI Systems</a><a class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] bg-[var(--bg-tertiary)]" href="/jarvis/">Jarvis Mode</a><a class="px-3 py-1.5 text-sm font-medium rounded-md transition-colors text-[var(--accent)] bg-[var(--accent-light)]" href="/architecture/structure/">Reference</a></div></div><nav class="overflow-y-auto h-[calc(100%-128px)] py-4 px-4"><ul class="space-y-1"><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Getting Started</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/">Home</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/getting-started/installation/">Installation</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/getting-started/configuration/">Configuration</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/getting-started/quickstart/">Quick Start</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Features</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/features/">Overview</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/features/checkins/">Daily Check-ins</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/features/bebits/">Bebits &amp; Rewards</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/features/chat/">AI Chat</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">AI Systems</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/">Overview</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/personality/">Dynamic Personality</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/moods/">Mood System</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/relationships/">Relationships</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/memory/">Semantic Memory</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/llm-evaluator/">LLM Evaluator</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/ai/tools/">Tool Calls</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Jarvis Mode 2.0</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/jarvis/">Overview</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/jarvis/commands/">Commands Reference</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/jarvis/parsing/">Intent Parsing</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/jarvis/fun/">Fun Commands</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Commands</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/commands/user/">User Commands</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/commands/admin/">Admin Commands</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Architecture</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/structure/">Project Structure</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--accent)] bg-[var(--accent-light)] font-medium" href="/architecture/database/">Database Schema</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/services/">Services</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/flow/">Message Flow</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Developer Guide</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/commands/">Extending Commands</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/tools/">Custom Tools</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/migrations/">Database Migrations</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/api/">API Reference</a></li></ul></li><li class="mb-4"><div class="px-3 py-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Deployment</div><ul class="mt-1 space-y-1"><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/railway/">Railway</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/vps/">VPS Setup</a></li><li><a class="block px-3 py-2 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/docker/">Docker</a></li></ul></li></ul></nav></aside><div class="flex"><aside class="hidden lg:block fixed top-[var(--header-height)] left-0 bottom-0 w-[var(--sidebar-width)] border-r border-[var(--border)] bg-[var(--bg-secondary)] overflow-y-auto"><nav class="py-6 px-4"><ul class="space-y-6"><li><div class="px-3 mb-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Architecture</div><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/structure/">Project Structure</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/database/">Database Schema</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/services/">Services</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/architecture/flow/">Message Flow</a></li></ul></li><li><div class="px-3 mb-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Developer Guide</div><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/commands/">Extending Commands</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/tools/">Custom Tools</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/migrations/">Database Migrations</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/dev/api/">API Reference</a></li></ul></li><li><div class="px-3 mb-2 text-xs font-semibold uppercase tracking-wider text-[var(--text-muted)]">Deployment</div><ul class="space-y-0.5"><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/railway/">Railway</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/vps/">VPS Setup</a></li><li><a class="block px-3 py-1.5 rounded-md text-sm transition-colors text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)]" href="/deployment/docker/">Docker</a></li></ul></li></ul></nav></aside><main class="flex-1 min-w-0 lg:pl-[var(--sidebar-width)]"><div class="max-w-[var(--content-max-width)] mx-auto px-6 py-8 lg:px-8 lg:py-12"><article class="animate-in"><div class="flex items-start justify-between gap-4 mb-6"><nav aria-label="Breadcrumb" class="flex items-center gap-1.5 text-sm mb-4"><div class="flex items-center gap-1.5"><a class="text-[var(--text-muted)] hover:text-[var(--text-primary)] transition-colors" href="/architecture/structure/">Architecture</a></div></nav><button class="flex items-center gap-1.5 px-3 py-1.5 text-sm text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-[var(--bg-tertiary)] rounded-md transition-colors border border-transparent hover:border-[var(--border)]" title="Copy page content"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-4 h-4"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy page</span></button></div><h1>Database Schema</h1><p class="text-lg text-[var(--text-secondary)] mb-8 -mt-2">Complete SQLite database schema and table documentation.</p><div class="prose-custom"><h1 id="database-schema">Database Schema</h1>
<p>Beboa uses SQLite via better-sqlite3 for data persistence.</p>
<h2 id="database-location"><a href="#database-location" class="anchor-link">Database Location</a></h2>
<div class="relative group my-6"><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-lg p-4"><code class="font-mono block"><div class="px-4"><span>data/beboa.db</span></div></code></pre><button class="absolute top-3 right-3 flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all opacity-0 group-hover:opacity-100 bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg></button></div>
<p>Created automatically on first run.</p>
<h2 id="tables"><a href="#tables" class="anchor-link">Tables</a></h2>
<h3 id="users"><a href="#users" class="anchor-link">users</a></h3>
<p>Core user data and engagement stats.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE users (</span></div><div class="px-4"><span>    user_id TEXT PRIMARY KEY,</span></div><div class="px-4"><span>    username TEXT,</span></div><div class="px-4"><span>    bebits INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    streak INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    longest_streak INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    total_checkins INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    last_checkin TEXT,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT CURRENT_TIMESTAMP,</span></div><div class="px-4"><span>    updated_at TEXT DEFAULT CURRENT_TIMESTAMP</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_users_bebits ON users(bebits DESC);</span></div><div class="px-4"><span>CREATE INDEX idx_users_streak ON users(streak DESC);</span></div></code></pre></div>
<table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>user_id</td><td>TEXT</td><td>Discord user ID (PK)</td></tr><tr><td>username</td><td>TEXT</td><td>Cached username</td></tr><tr><td>bebits</td><td>INTEGER</td><td>Currency balance</td></tr><tr><td>streak</td><td>INTEGER</td><td>Current check-in streak</td></tr><tr><td>longest_streak</td><td>INTEGER</td><td>Best streak ever</td></tr><tr><td>total_checkins</td><td>INTEGER</td><td>Lifetime check-ins</td></tr><tr><td>last_checkin</td><td>TEXT</td><td>ISO timestamp</td></tr><tr><td>created_at</td><td>TEXT</td><td>First interaction</td></tr><tr><td>updated_at</td><td>TEXT</td><td>Last modification</td></tr></tbody></table>
<hr/>
<h3 id="relationships"><a href="#relationships" class="anchor-link">relationships</a></h3>
<p>Per-user relationship tracking.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE relationships (</span></div><div class="px-4"><span>    user_id TEXT PRIMARY KEY,</span></div><div class="px-4"><span>    trust_level REAL DEFAULT 10.0,</span></div><div class="px-4"><span>    relationship_stage TEXT DEFAULT &#x27;stranger&#x27;,</span></div><div class="px-4"><span>    total_interactions INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    positive_interactions INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    negative_interactions INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    first_interaction TEXT,</span></div><div class="px-4"><span>    last_interaction TEXT,</span></div><div class="px-4"><span>    notes TEXT,</span></div><div class="px-4"><span>    FOREIGN KEY (user_id) REFERENCES users(user_id)</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>user_id</td><td>TEXT</td><td>Discord user ID (PK)</td></tr><tr><td>trust_level</td><td>REAL</td><td>0-100 trust score</td></tr><tr><td>relationship_stage</td><td>TEXT</td><td>stranger/acquaintance/familiar/friend/close_friend/family</td></tr><tr><td>total_interactions</td><td>INTEGER</td><td>All interactions</td></tr><tr><td>positive_interactions</td><td>INTEGER</td><td>Pleasant exchanges</td></tr><tr><td>negative_interactions</td><td>INTEGER</td><td>Unpleasant exchanges</td></tr><tr><td>first_interaction</td><td>TEXT</td><td>First message timestamp</td></tr><tr><td>last_interaction</td><td>TEXT</td><td>Most recent timestamp</td></tr><tr><td>notes</td><td>TEXT</td><td>Admin notes JSON</td></tr></tbody></table>
<hr/>
<h3 id="memories"><a href="#memories" class="anchor-link">memories</a></h3>
<p>Semantic memory storage with embeddings.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE memories (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    user_id TEXT,</span></div><div class="px-4"><span>    content TEXT NOT NULL,</span></div><div class="px-4"><span>    memory_type TEXT DEFAULT &#x27;fact&#x27;,</span></div><div class="px-4"><span>    importance REAL DEFAULT 0.5,</span></div><div class="px-4"><span>    embedding BLOB,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT CURRENT_TIMESTAMP,</span></div><div class="px-4"><span>    last_accessed TEXT,</span></div><div class="px-4"><span>    access_count INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    FOREIGN KEY (user_id) REFERENCES users(user_id)</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_memories_user ON memories(user_id);</span></div><div class="px-4"><span>CREATE INDEX idx_memories_type ON memories(memory_type);</span></div><div class="px-4"><span>CREATE INDEX idx_memories_importance ON memories(importance DESC);</span></div></code></pre></div>
<table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>id</td><td>INTEGER</td><td>Auto-increment PK</td></tr><tr><td>user_id</td><td>TEXT</td><td>Associated user</td></tr><tr><td>content</td><td>TEXT</td><td>Memory content</td></tr><tr><td>memory_type</td><td>TEXT</td><td>fact/preference/event/relationship/emotional/context</td></tr><tr><td>importance</td><td>REAL</td><td>0.0-1.0 relevance score</td></tr><tr><td>embedding</td><td>BLOB</td><td>1536-dim vector (binary)</td></tr><tr><td>created_at</td><td>TEXT</td><td>Creation timestamp</td></tr><tr><td>last_accessed</td><td>TEXT</td><td>Last retrieval</td></tr><tr><td>access_count</td><td>INTEGER</td><td>Times retrieved</td></tr></tbody></table>
<hr/>
<h3 id="personality"><a href="#personality" class="anchor-link">personality</a></h3>
<p>Global personality state (single row).</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE personality (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY DEFAULT 1,</span></div><div class="px-4"><span>    openness REAL DEFAULT 0.7,</span></div><div class="px-4"><span>    conscientiousness REAL DEFAULT 0.4,</span></div><div class="px-4"><span>    extraversion REAL DEFAULT 0.6,</span></div><div class="px-4"><span>    agreeableness REAL DEFAULT 0.3,</span></div><div class="px-4"><span>    neuroticism REAL DEFAULT 0.5,</span></div><div class="px-4"><span>    playfulness REAL DEFAULT 0.8,</span></div><div class="px-4"><span>    sarcasm REAL DEFAULT 0.85,</span></div><div class="px-4"><span>    protectiveness REAL DEFAULT 0.7,</span></div><div class="px-4"><span>    curiosity REAL DEFAULT 0.65,</span></div><div class="px-4"><span>    stubbornness REAL DEFAULT 0.75,</span></div><div class="px-4"><span>    affection_hidden REAL DEFAULT 0.8,</span></div><div class="px-4"><span>    mischief REAL DEFAULT 0.7,</span></div><div class="px-4"><span>    drama REAL DEFAULT 0.6,</span></div><div class="px-4"><span>    loyalty REAL DEFAULT 0.9,</span></div><div class="px-4"><span>    last_updated TEXT</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<p>All trait columns are REAL values between 0.0 and 1.0.</p>
<hr/>
<h3 id="mood_state"><a href="#mood_state" class="anchor-link">mood_state</a></h3>
<p>Current mood (single row).</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE mood_state (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY DEFAULT 1,</span></div><div class="px-4"><span>    current_mood TEXT DEFAULT &#x27;neutral&#x27;,</span></div><div class="px-4"><span>    mood_intensity REAL DEFAULT 0.5,</span></div><div class="px-4"><span>    last_changed TEXT,</span></div><div class="px-4"><span>    trigger_reason TEXT</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>current_mood</td><td>TEXT</td><td>Active mood name</td></tr><tr><td>mood_intensity</td><td>REAL</td><td>0.0-1.0 strength</td></tr><tr><td>last_changed</td><td>TEXT</td><td>Change timestamp</td></tr><tr><td>trigger_reason</td><td>TEXT</td><td>What caused change</td></tr></tbody></table>
<hr/>
<h3 id="redemptions"><a href="#redemptions" class="anchor-link">redemptions</a></h3>
<p>Reward redemption history.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE redemptions (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    user_id TEXT,</span></div><div class="px-4"><span>    reward_name TEXT,</span></div><div class="px-4"><span>    reward_tier INTEGER,</span></div><div class="px-4"><span>    cost INTEGER,</span></div><div class="px-4"><span>    redeemed_at TEXT DEFAULT CURRENT_TIMESTAMP,</span></div><div class="px-4"><span>    fulfilled INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    fulfilled_by TEXT,</span></div><div class="px-4"><span>    fulfilled_at TEXT,</span></div><div class="px-4"><span>    FOREIGN KEY (user_id) REFERENCES users(user_id)</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_redemptions_user ON redemptions(user_id);</span></div><div class="px-4"><span>CREATE INDEX idx_redemptions_fulfilled ON redemptions(fulfilled);</span></div></code></pre></div>
<hr/>
<h3 id="chat_history"><a href="#chat_history" class="anchor-link">chat_history</a></h3>
<p>Conversation history per user.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE chat_history (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    user_id TEXT,</span></div><div class="px-4"><span>    role TEXT,  -- &#x27;user&#x27; or &#x27;assistant&#x27;</span></div><div class="px-4"><span>    content TEXT,</span></div><div class="px-4"><span>    timestamp TEXT DEFAULT CURRENT_TIMESTAMP,</span></div><div class="px-4"><span>    FOREIGN KEY (user_id) REFERENCES users(user_id)</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_chat_user ON chat_history(user_id);</span></div><div class="px-4"><span>CREATE INDEX idx_chat_timestamp ON chat_history(timestamp DESC);</span></div></code></pre></div>
<hr/>
<h3 id="jarvis_access"><a href="#jarvis_access" class="anchor-link">jarvis_access</a></h3>
<p>Jarvis Mode permissions.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE jarvis_access (</span></div><div class="px-4"><span>    user_id TEXT PRIMARY KEY,</span></div><div class="px-4"><span>    granted_by TEXT,</span></div><div class="px-4"><span>    granted_at TEXT DEFAULT CURRENT_TIMESTAMP</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<hr/>
<h3 id="admin_log"><a href="#admin_log" class="anchor-link">admin_log</a></h3>
<p>Admin action audit trail.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE admin_log (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    admin_id TEXT,</span></div><div class="px-4"><span>    command TEXT,</span></div><div class="px-4"><span>    target_id TEXT,</span></div><div class="px-4"><span>    details TEXT,  -- JSON</span></div><div class="px-4"><span>    result TEXT,</span></div><div class="px-4"><span>    timestamp TEXT DEFAULT CURRENT_TIMESTAMP</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_admin_log_admin ON admin_log(admin_id);</span></div><div class="px-4"><span>CREATE INDEX idx_admin_log_timestamp ON admin_log(timestamp DESC);</span></div></code></pre></div>
<hr/>
<h2 id="server-memory-tables"><a href="#server-memory-tables" class="anchor-link">Server Memory Tables</a></h2>
<p>These tables power the <a href="/ai/server-memory">server-wide memory system</a>.</p>
<h3 id="server_messages"><a href="#server_messages" class="anchor-link">server_messages</a></h3>
<p>Raw storage for ALL server messages.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE server_messages (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    message_id TEXT UNIQUE NOT NULL,</span></div><div class="px-4"><span>    channel_id TEXT NOT NULL,</span></div><div class="px-4"><span>    guild_id TEXT NOT NULL,</span></div><div class="px-4"><span>    author_id TEXT NOT NULL,</span></div><div class="px-4"><span>    author_name TEXT NOT NULL,</span></div><div class="px-4"><span>    content TEXT NOT NULL,</span></div><div class="px-4"><span>    content_length INTEGER NOT NULL,</span></div><div class="px-4"><span>    has_attachments INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    reply_to_id TEXT,</span></div><div class="px-4"><span>    importance_score REAL DEFAULT 0.0,</span></div><div class="px-4"><span>    embedding_status TEXT DEFAULT &#x27;pending&#x27;,</span></div><div class="px-4"><span>    discord_created_at TEXT NOT NULL,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT (datetime(&#x27;now&#x27;))</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_sm_channel ON server_messages(channel_id, discord_created_at DESC);</span></div><div class="px-4"><span>CREATE INDEX idx_sm_author ON server_messages(author_id);</span></div><div class="px-4"><span>CREATE INDEX idx_sm_time ON server_messages(discord_created_at DESC);</span></div><div class="px-4"><span>CREATE INDEX idx_sm_status ON server_messages(embedding_status);</span></div><div class="px-4"><span>CREATE INDEX idx_sm_importance ON server_messages(importance_score DESC);</span></div></code></pre></div>
<table><thead><tr><th>Column</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td>message_id</td><td>TEXT</td><td>Discord message snowflake (unique)</td></tr><tr><td>channel_id</td><td>TEXT</td><td>Source channel ID</td></tr><tr><td>guild_id</td><td>TEXT</td><td>Server ID</td></tr><tr><td>importance_score</td><td>REAL</td><td>0.0-1.0 importance score</td></tr><tr><td>embedding_status</td><td>TEXT</td><td>pending/embedded/skipped/failed</td></tr></tbody></table>
<hr/>
<h3 id="server_embeddings"><a href="#server_embeddings" class="anchor-link">server_embeddings</a></h3>
<p>Vectors for important messages.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE server_embeddings (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    message_id INTEGER,</span></div><div class="px-4"><span>    summary_id INTEGER,</span></div><div class="px-4"><span>    embedding BLOB NOT NULL,</span></div><div class="px-4"><span>    source_text TEXT NOT NULL,</span></div><div class="px-4"><span>    source_type TEXT DEFAULT &#x27;message&#x27;,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT (datetime(&#x27;now&#x27;)),</span></div><div class="px-4"><span>    FOREIGN KEY (message_id) REFERENCES server_messages(id),</span></div><div class="px-4"><span>    FOREIGN KEY (summary_id) REFERENCES channel_summaries(id)</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<hr/>
<h3 id="channel_summaries"><a href="#channel_summaries" class="anchor-link">channel_summaries</a></h3>
<p>Periodic channel rollups.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE channel_summaries (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    channel_id TEXT NOT NULL,</span></div><div class="px-4"><span>    guild_id TEXT NOT NULL,</span></div><div class="px-4"><span>    period_type TEXT NOT NULL,</span></div><div class="px-4"><span>    period_start TEXT NOT NULL,</span></div><div class="px-4"><span>    period_end TEXT NOT NULL,</span></div><div class="px-4"><span>    summary TEXT NOT NULL,</span></div><div class="px-4"><span>    key_topics TEXT,</span></div><div class="px-4"><span>    key_participants TEXT,</span></div><div class="px-4"><span>    message_count INTEGER NOT NULL,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT (datetime(&#x27;now&#x27;)),</span></div><div class="px-4"><span>    UNIQUE(channel_id, period_type, period_start)</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<hr/>
<h3 id="active_topics"><a href="#active_topics" class="anchor-link">active_topics</a></h3>
<p>Topic lifecycle tracking.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE active_topics (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    guild_id TEXT NOT NULL,</span></div><div class="px-4"><span>    topic_name TEXT NOT NULL,</span></div><div class="px-4"><span>    mention_count INTEGER DEFAULT 1,</span></div><div class="px-4"><span>    status TEXT DEFAULT &#x27;active&#x27;,</span></div><div class="px-4"><span>    last_seen_at TEXT DEFAULT (datetime(&#x27;now&#x27;))</span></div><div class="px-4"><span>);</span></div></code></pre></div>
<hr/>
<h3 id="embedding_queue"><a href="#embedding_queue" class="anchor-link">embedding_queue</a></h3>
<p>Background processing queue.</p>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>CREATE TABLE embedding_queue (</span></div><div class="px-4"><span>    id INTEGER PRIMARY KEY AUTOINCREMENT,</span></div><div class="px-4"><span>    message_id INTEGER NOT NULL,</span></div><div class="px-4"><span>    priority INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    status TEXT DEFAULT &#x27;pending&#x27;,</span></div><div class="px-4"><span>    retry_count INTEGER DEFAULT 0,</span></div><div class="px-4"><span>    error_message TEXT,</span></div><div class="px-4"><span>    created_at TEXT DEFAULT (datetime(&#x27;now&#x27;)),</span></div><div class="px-4"><span>    processed_at TEXT,</span></div><div class="px-4"><span>    FOREIGN KEY (message_id) REFERENCES server_messages(id)</span></div><div class="px-4"><span>);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>CREATE INDEX idx_eq_status ON embedding_queue(status, priority DESC);</span></div></code></pre></div>
<hr/>
<h2 id="common-queries"><a href="#common-queries" class="anchor-link">Common Queries</a></h2>
<h3 id="get-user-with-stats"><a href="#get-user-with-stats" class="anchor-link">Get User with Stats</a></h3>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>SELECT</span></div><div class="px-4"><span>    u.*,</span></div><div class="px-4"><span>    r.trust_level,</span></div><div class="px-4"><span>    r.relationship_stage,</span></div><div class="px-4"><span>    (SELECT COUNT(*) FROM memories WHERE user_id = u.user_id) as memory_count</span></div><div class="px-4"><span>FROM users u</span></div><div class="px-4"><span>LEFT JOIN relationships r ON u.user_id = r.user_id</span></div><div class="px-4"><span>WHERE u.user_id = ?;</span></div></code></pre></div>
<h3 id="leaderboard"><a href="#leaderboard" class="anchor-link">Leaderboard</a></h3>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">sql</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>SELECT user_id, username, bebits,</span></div><div class="px-4"><span>       ROW_NUMBER() OVER (ORDER BY bebits DESC) as rank</span></div><div class="px-4"><span>FROM users</span></div><div class="px-4"><span>ORDER BY bebits DESC</span></div><div class="px-4"><span>LIMIT 10;</span></div></code></pre></div>
<h3 id="search-memories"><a href="#search-memories" class="anchor-link">Search Memories</a></h3>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">javascript</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span>// Semantic search requires application-level processing</span></div><div class="px-4"><span>const allMemories = db.prepare(`</span></div><div class="px-4"><span>    SELECT * FROM memories</span></div><div class="px-4"><span>    WHERE user_id = ?</span></div><div class="px-4"><span>    ORDER BY importance DESC</span></div><div class="px-4"><span>`).all(userId);</span></div><div class="px-4"><span> </span></div><div class="px-4"><span>// Then compute cosine similarity with query embedding</span></div><div class="px-4"><span>const relevant = allMemories</span></div><div class="px-4"><span>    .map(m =&gt; ({ ...m, similarity: cosineSimilarity(queryEmbedding, m.embedding) }))</span></div><div class="px-4"><span>    .filter(m =&gt; m.similarity &gt; 0.7)</span></div><div class="px-4"><span>    .sort((a, b) =&gt; b.similarity - a.similarity);</span></div></code></pre></div>
<h2 id="migrations"><a href="#migrations" class="anchor-link">Migrations</a></h2>
<p>See <a href="../dev/migrations.md">Database Migrations</a> for schema updates.</p>
<h2 id="backup"><a href="#backup" class="anchor-link">Backup</a></h2>
<div class="relative group my-6"><div class="flex items-center justify-between px-4 py-2 bg-[#2d2d2d] dark:bg-[#1a1a1a] border-b border-[#3d3d3d] rounded-t-lg"><span class="text-xs font-medium text-[#9a9a9a]">bash</span><button class="flex items-center gap-1.5 px-2.5 py-1 text-xs font-medium rounded transition-all bg-[#3d3d3d] text-[#9a9a9a] hover:bg-[#4d4d4d] hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy w-3.5 h-3.5"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"></rect><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"></path></svg><span>Copy</span></button></div><pre class="overflow-x-auto text-sm bg-[var(--code-bg)] text-[var(--code-text)] rounded-b-lg rounded-t-none p-4"><code class="font-mono block"><div class="px-4"><span># Copy database file</span></div><div class="px-4"><span>cp data/beboa.db data/beboa_backup_$(date +%Y%m%d).db</span></div><div class="px-4"><span> </span></div><div class="px-4"><span># Or use SQLite dump</span></div><div class="px-4"><span>sqlite3 data/beboa.db .dump &gt; backup.sql</span></div></code></pre></div>
<h2 id="performance"><a href="#performance" class="anchor-link">Performance</a></h2>
<table><thead><tr><th>Table</th><th>Expected Rows</th><th>Index Strategy</th></tr></thead><tbody><tr><td>users</td><td>100-10000</td><td>bebits, streak</td></tr><tr><td>memories</td><td>1000-100000</td><td>user_id, importance</td></tr><tr><td>chat_history</td><td>10000-1M</td><td>user_id, timestamp</td></tr><tr><td>admin_log</td><td>1000-100000</td><td>timestamp</td></tr><tr><td>server_messages</td><td>10000-1M</td><td>channel_id+time, author_id</td></tr><tr><td>server_embeddings</td><td>1000-100000</td><td>message_id</td></tr><tr><td>embedding_queue</td><td>0-1000</td><td>status+priority</td></tr></tbody></table>
<p>For large servers (&gt;10k users), consider:</p>
<ul>
<li>Regular vacuuming: <code>VACUUM;</code></li>
<li>Chat history pruning</li>
<li>Memory importance decay</li>
<li>Server message retention (default: 30 days)</li>
</ul></div><nav class="flex items-center justify-between mt-16 pt-8 border-t border-[var(--border)]"><a class="group flex items-center gap-2 px-4 py-3 rounded-lg border border-[var(--border)] bg-[var(--bg-secondary)] hover:border-[var(--accent)] hover:shadow-soft transition-all" href="/architecture/structure/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-left w-5 h-5 text-[var(--text-muted)] group-hover:text-[var(--accent)] transition-colors"><path d="m15 18-6-6 6-6"></path></svg><div class="text-left"><div class="text-xs text-[var(--text-muted)] mb-0.5">Previous</div><div class="text-sm font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors">Project Structure</div></div></a><a class="group flex items-center gap-2 px-4 py-3 rounded-lg border border-[var(--border)] bg-[var(--bg-secondary)] hover:border-[var(--accent)] hover:shadow-soft transition-all" href="/architecture/services/"><div class="text-right"><div class="text-xs text-[var(--text-muted)] mb-0.5">Next</div><div class="text-sm font-medium text-[var(--text-primary)] group-hover:text-[var(--accent)] transition-colors">Services</div></div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-right w-5 h-5 text-[var(--text-muted)] group-hover:text-[var(--accent)] transition-colors"><path d="m9 18 6-6-6-6"></path></svg></a></nav></article></div></main></div></div></div><script src="/_next/static/chunks/webpack-e5714bf66625afb9.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/443896d591e4f761-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/e4af272ccee01ff0-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/3cf59f0fd0496c15.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[2846,[],\"\"]\n7:I[4707,[],\"\"]\n9:I[6423,[],\"\"]\na:I[2060,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"185\",\"static/chunks/app/layout-4b75b78215e64ea2.js\"],\"ThemeProvider\"]\nb:I[4351,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"185\",\"static/chunks/app/layout-4b75b78215e64ea2.js\"],\"Header\"]\nc:I[9399,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"185\",\"static/chunks/app/layout-4b75b78215e64ea2.js\"],\"Sidebar\"]\ne:I[1060,[],\"\"]\n8:[\"slug\",\"architecture/database\",\"c\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[\"$\",\"$L4\",null,{\"buildId\":\"FeUt14WxB_Uw-6zJdn3nr\",\"assetPrefix\":\"\",\"urlParts\":[\"\",\"architecture\",\"database\",\"\"],\"initialTree\":[\"\",{\"children\":[[\"slug\",\"architecture/database\",\"c\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":[\\\"architecture\\\",\\\"database\\\"]}\",{}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[[\"slug\",\"architecture/database\",\"c\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",\"$L6\",null],null],null]},[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"$8\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]],null]},[[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/3cf59f0fd0496c15.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_f367f3 __variable_a06722 font-sans\",\"children\":[\"$\",\"$La\",null,{\"children\":[\"$\",\"div\",null,{\"className\":\"min-h-screen bg-[var(--bg-primary)] transition-colors duration-200\",\"children\":[[\"$\",\"$Lb\",null,{}],[\"$\",\"div\",null,{\"className\":\"flex\",\"children\":[[\"$\",\"$Lc\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-1 min-w-0 lg:pl-[var(--sidebar-width)]\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-[var(--content-max-width)] mx-auto px-6 py-8 lg:px-8 lg:py-12\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[]}]}]}]]}]]}]}]}]}]],null],null],\"couldBeIntercepted\":false,\"initialHead\":[null,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]\n"])</script><script>self.__next_f.push([1,"10:I[6430,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js\"],\"Breadcrumbs\"]\n11:I[9078,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js\"],\"CopyPageButton\"]\n13:I[3308,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js\"],\"PageNavigation\"]\n14:I[5321,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js\"],\"TableOfContents\"]\n6:[[\"$\",\"article\",null,{\"className\":\"animate-in\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-start justify-between gap-4 mb-6\",\"children\":[[\"$\",\"$L10\",null,{}],[\"$\",\"$L11\",null,{}]]}],[\"$\",\"h1\",null,{\"children\":\"Database Schema\"}],[\"$\",\"p\",null,{\"className\":\"text-lg text-[var(--text-secondary)] mb-8 -mt-2\",\"children\":\"Complete SQLite database schema and table documentation.\"}],[\"$\",\"div\",null,{\"className\":\"prose-custom\",\"children\":\"$L12\"}],[\"$\",\"$L13\",null,{}]]}],[\"$\",\"$L14\",null,{}]]\nd:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Database Schema - Beboa Docs\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"Complete SQLite database schema and table documentation.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}],[\"$\",\"meta\",\"5\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script><script>self.__next_f.push([1,"15:I[5045,[\"972\",\"static/chunks/972-68a674eeca97bbbb.js\",\"646\",\"static/chunks/646-1e67c3e800eb58dd.js\",\"877\",\"static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js\"],\"CodeBlock\"]\n"])</script><script>self.__next_f.push([1,"12:[[\"$\",\"h1\",null,{\"id\":\"database-schema\",\"children\":\"Database Schema\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Beboa uses SQLite via better-sqlite3 for data persistence.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"database-location\",\"children\":[\"$\",\"a\",null,{\"href\":\"#database-location\",\"className\":\"anchor-link\",\"children\":\"Database Location\"}]}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"$undefined\",\"children\":\"data/beboa.db\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Created automatically on first run.\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"tables\",\"children\":[\"$\",\"a\",null,{\"href\":\"#tables\",\"className\":\"anchor-link\",\"children\":\"Tables\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"users\",\"children\":[\"$\",\"a\",null,{\"href\":\"#users\",\"className\":\"anchor-link\",\"children\":\"users\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Core user data and engagement stats.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE users (\\n    user_id TEXT PRIMARY KEY,\\n    username TEXT,\\n    bebits INTEGER DEFAULT 0,\\n    streak INTEGER DEFAULT 0,\\n    longest_streak INTEGER DEFAULT 0,\\n    total_checkins INTEGER DEFAULT 0,\\n    last_checkin TEXT,\\n    created_at TEXT DEFAULT CURRENT_TIMESTAMP,\\n    updated_at TEXT DEFAULT CURRENT_TIMESTAMP\\n);\\n\\nCREATE INDEX idx_users_bebits ON users(bebits DESC);\\nCREATE INDEX idx_users_streak ON users(streak DESC);\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Column\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"user_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Discord user ID (PK)\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"username\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Cached username\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"bebits\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Currency balance\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"streak\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Current check-in streak\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"longest_streak\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Best streak ever\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"total_checkins\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Lifetime check-ins\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"last_checkin\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"ISO timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"created_at\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"First interaction\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"updated_at\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Last modification\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"relationships\",\"children\":[\"$\",\"a\",null,{\"href\":\"#relationships\",\"className\":\"anchor-link\",\"children\":\"relationships\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Per-user relationship tracking.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE relationships (\\n    user_id TEXT PRIMARY KEY,\\n    trust_level REAL DEFAULT 10.0,\\n    relationship_stage TEXT DEFAULT 'stranger',\\n    total_interactions INTEGER DEFAULT 0,\\n    positive_interactions INTEGER DEFAULT 0,\\n    negative_interactions INTEGER DEFAULT 0,\\n    first_interaction TEXT,\\n    last_interaction TEXT,\\n    notes TEXT,\\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\\n);\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Column\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"user_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Discord user ID (PK)\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"trust_level\"}],[\"$\",\"td\",null,{\"children\":\"REAL\"}],[\"$\",\"td\",null,{\"children\":\"0-100 trust score\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"relationship_stage\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"stranger/acquaintance/familiar/friend/close_friend/family\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"total_interactions\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"All interactions\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"positive_interactions\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Pleasant exchanges\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"negative_interactions\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Unpleasant exchanges\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"first_interaction\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"First message timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"last_interaction\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Most recent timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"notes\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Admin notes JSON\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"memories\",\"children\":[\"$\",\"a\",null,{\"href\":\"#memories\",\"className\":\"anchor-link\",\"children\":\"memories\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Semantic memory storage with embeddings.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE memories (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    user_id TEXT,\\n    content TEXT NOT NULL,\\n    memory_type TEXT DEFAULT 'fact',\\n    importance REAL DEFAULT 0.5,\\n    embedding BLOB,\\n    created_at TEXT DEFAULT CURRENT_TIMESTAMP,\\n    last_accessed TEXT,\\n    access_count INTEGER DEFAULT 0,\\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\\n);\\n\\nCREATE INDEX idx_memories_user ON memories(user_id);\\nCREATE INDEX idx_memories_type ON memories(memory_type);\\nCREATE INDEX idx_memories_importance ON memories(importance DESC);\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Column\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"id\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Auto-increment PK\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"user_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Associated user\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"content\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Memory content\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"memory_type\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"fact/preference/event/relationship/emotional/context\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"importance\"}],[\"$\",\"td\",null,{\"children\":\"REAL\"}],[\"$\",\"td\",null,{\"children\":\"0.0-1.0 relevance score\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"embedding\"}],[\"$\",\"td\",null,{\"children\":\"BLOB\"}],[\"$\",\"td\",null,{\"children\":\"1536-dim vector (binary)\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"created_at\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Creation timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"last_accessed\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Last retrieval\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"access_count\"}],[\"$\",\"td\",null,{\"children\":\"INTEGER\"}],[\"$\",\"td\",null,{\"children\":\"Times retrieved\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"personality\",\"children\":[\"$\",\"a\",null,{\"href\":\"#personality\",\"className\":\"anchor-link\",\"children\":\"personality\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Global personality state (single row).\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE personality (\\n    id INTEGER PRIMARY KEY DEFAULT 1,\\n    openness REAL DEFAULT 0.7,\\n    conscientiousness REAL DEFAULT 0.4,\\n    extraversion REAL DEFAULT 0.6,\\n    agreeableness REAL DEFAULT 0.3,\\n    neuroticism REAL DEFAULT 0.5,\\n    playfulness REAL DEFAULT 0.8,\\n    sarcasm REAL DEFAULT 0.85,\\n    protectiveness REAL DEFAULT 0.7,\\n    curiosity REAL DEFAULT 0.65,\\n    stubbornness REAL DEFAULT 0.75,\\n    affection_hidden REAL DEFAULT 0.8,\\n    mischief REAL DEFAULT 0.7,\\n    drama REAL DEFAULT 0.6,\\n    loyalty REAL DEFAULT 0.9,\\n    last_updated TEXT\\n);\"}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"All trait columns are REAL values between 0.0 and 1.0.\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"mood_state\",\"children\":[\"$\",\"a\",null,{\"href\":\"#mood_state\",\"className\":\"anchor-link\",\"children\":\"mood_state\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Current mood (single row).\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE mood_state (\\n    id INTEGER PRIMARY KEY DEFAULT 1,\\n    current_mood TEXT DEFAULT 'neutral',\\n    mood_intensity REAL DEFAULT 0.5,\\n    last_changed TEXT,\\n    trigger_reason TEXT\\n);\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Column\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"current_mood\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Active mood name\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"mood_intensity\"}],[\"$\",\"td\",null,{\"children\":\"REAL\"}],[\"$\",\"td\",null,{\"children\":\"0.0-1.0 strength\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"last_changed\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Change timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"trigger_reason\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"What caused change\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"redemptions\",\"children\":[\"$\",\"a\",null,{\"href\":\"#redemptions\",\"className\":\"anchor-link\",\"children\":\"redemptions\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Reward redemption history.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE redemptions (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    user_id TEXT,\\n    reward_name TEXT,\\n    reward_tier INTEGER,\\n    cost INTEGER,\\n    redeemed_at TEXT DEFAULT CURRENT_TIMESTAMP,\\n    fulfilled INTEGER DEFAULT 0,\\n    fulfilled_by TEXT,\\n    fulfilled_at TEXT,\\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\\n);\\n\\nCREATE INDEX idx_redemptions_user ON redemptions(user_id);\\nCREATE INDEX idx_redemptions_fulfilled ON redemptions(fulfilled);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"chat_history\",\"children\":[\"$\",\"a\",null,{\"href\":\"#chat_history\",\"className\":\"anchor-link\",\"children\":\"chat_history\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Conversation history per user.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE chat_history (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    user_id TEXT,\\n    role TEXT,  -- 'user' or 'assistant'\\n    content TEXT,\\n    timestamp TEXT DEFAULT CURRENT_TIMESTAMP,\\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\\n);\\n\\nCREATE INDEX idx_chat_user ON chat_history(user_id);\\nCREATE INDEX idx_chat_timestamp ON chat_history(timestamp DESC);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"jarvis_access\",\"children\":[\"$\",\"a\",null,{\"href\":\"#jarvis_access\",\"className\":\"anchor-link\",\"children\":\"jarvis_access\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Jarvis Mode permissions.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE jarvis_access (\\n    user_id TEXT PRIMARY KEY,\\n    granted_by TEXT,\\n    granted_at TEXT DEFAULT CURRENT_TIMESTAMP\\n);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"admin_log\",\"children\":[\"$\",\"a\",null,{\"href\":\"#admin_log\",\"className\":\"anchor-link\",\"children\":\"admin_log\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Admin action audit trail.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE admin_log (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    admin_id TEXT,\\n    command TEXT,\\n    target_id TEXT,\\n    details TEXT,  -- JSON\\n    result TEXT,\\n    timestamp TEXT DEFAULT CURRENT_TIMESTAMP\\n);\\n\\nCREATE INDEX idx_admin_log_admin ON admin_log(admin_id);\\nCREATE INDEX idx_admin_log_timestamp ON admin_log(timestamp DESC);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"server-memory-tables\",\"children\":[\"$\",\"a\",null,{\"href\":\"#server-memory-tables\",\"className\":\"anchor-link\",\"children\":\"Server Memory Tables\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"These tables power the \",[\"$\",\"a\",null,{\"href\":\"/ai/server-memory\",\"children\":\"server-wide memory system\"}],\".\"]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"server_messages\",\"children\":[\"$\",\"a\",null,{\"href\":\"#server_messages\",\"className\":\"anchor-link\",\"children\":\"server_messages\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Raw storage for ALL server messages.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE server_messages (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    message_id TEXT UNIQUE NOT NULL,\\n    channel_id TEXT NOT NULL,\\n    guild_id TEXT NOT NULL,\\n    author_id TEXT NOT NULL,\\n    author_name TEXT NOT NULL,\\n    content TEXT NOT NULL,\\n    content_length INTEGER NOT NULL,\\n    has_attachments INTEGER DEFAULT 0,\\n    reply_to_id TEXT,\\n    importance_score REAL DEFAULT 0.0,\\n    embedding_status TEXT DEFAULT 'pending',\\n    discord_created_at TEXT NOT NULL,\\n    created_at TEXT DEFAULT (datetime('now'))\\n);\\n\\nCREATE INDEX idx_sm_channel ON server_messages(channel_id, discord_created_at DESC);\\nCREATE INDEX idx_sm_author ON server_messages(author_id);\\nCREATE INDEX idx_sm_time ON server_messages(discord_created_at DESC);\\nCREATE INDEX idx_sm_status ON server_messages(embedding_status);\\nCREATE INDEX idx_sm_importance ON server_messages(importance_score DESC);\"}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Column\"}],[\"$\",\"th\",null,{\"children\":\"Type\"}],[\"$\",\"th\",null,{\"children\":\"Description\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"message_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Discord message snowflake (unique)\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"channel_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Source channel ID\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"guild_id\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"Server ID\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"importance_score\"}],[\"$\",\"td\",null,{\"children\":\"REAL\"}],[\"$\",\"td\",null,{\"children\":\"0.0-1.0 importance score\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"embedding_status\"}],[\"$\",\"td\",null,{\"children\":\"TEXT\"}],[\"$\",\"td\",null,{\"children\":\"pending/embedded/skipped/failed\"}]]}]]}]]}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"server_embeddings\",\"children\":[\"$\",\"a\",null,{\"href\":\"#server_embeddings\",\"className\":\"anchor-link\",\"children\":\"server_embeddings\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Vectors for important messages.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE server_embeddings (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    message_id INTEGER,\\n    summary_id INTEGER,\\n    embedding BLOB NOT NULL,\\n    source_text TEXT NOT NULL,\\n    source_type TEXT DEFAULT 'message',\\n    created_at TEXT DEFAULT (datetime('now')),\\n    FOREIGN KEY (message_id) REFERENCES server_messages(id),\\n    FOREIGN KEY (summary_id) REFERENCES channel_summaries(id)\\n);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"channel_summaries\",\"children\":[\"$\",\"a\",null,{\"href\":\"#channel_summaries\",\"className\":\"anchor-link\",\"children\":\"channel_summaries\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Periodic channel rollups.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE channel_summaries (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    channel_id TEXT NOT NULL,\\n    guild_id TEXT NOT NULL,\\n    period_type TEXT NOT NULL,\\n    period_start TEXT NOT NULL,\\n    period_end TEXT NOT NULL,\\n    summary TEXT NOT NULL,\\n    key_topics TEXT,\\n    key_participants TEXT,\\n    message_count INTEGER NOT NULL,\\n    created_at TEXT DEFAULT (datetime('now')),\\n    UNIQUE(channel_id, period_type, period_start)\\n);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"active_topics\",\"children\":[\"$\",\"a\",null,{\"href\":\"#active_topics\",\"className\":\"anchor-link\",\"children\":\"active_topics\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Topic lifecycle tracking.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE active_topics (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    guild_id TEXT NOT NULL,\\n    topic_name TEXT NOT NULL,\\n    mention_count INTEGER DEFAULT 1,\\n    status TEXT DEFAULT 'active',\\n    last_seen_at TEXT DEFAULT (datetime('now'))\\n);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"embedding_queue\",\"children\":[\"$\",\"a\",null,{\"href\":\"#embedding_queue\",\"className\":\"anchor-link\",\"children\":\"embedding_queue\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"Background processing queue.\"}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"CREATE TABLE embedding_queue (\\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\\n    message_id INTEGER NOT NULL,\\n    priority INTEGER DEFAULT 0,\\n    status TEXT DEFAULT 'pending',\\n    retry_count INTEGER DEFAULT 0,\\n    error_message TEXT,\\n    created_at TEXT DEFAULT (datetime('now')),\\n    processed_at TEXT,\\n    FOREIGN KEY (message_id) REFERENCES server_messages(id)\\n);\\n\\nCREATE INDEX idx_eq_status ON embedding_queue(status, priority DESC);\"}],\"\\n\",[\"$\",\"hr\",null,{}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"common-queries\",\"children\":[\"$\",\"a\",null,{\"href\":\"#common-queries\",\"className\":\"anchor-link\",\"children\":\"Common Queries\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"get-user-with-stats\",\"children\":[\"$\",\"a\",null,{\"href\":\"#get-user-with-stats\",\"className\":\"anchor-link\",\"children\":\"Get User with Stats\"}]}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"SELECT\\n    u.*,\\n    r.trust_level,\\n    r.relationship_stage,\\n    (SELECT COUNT(*) FROM memories WHERE user_id = u.user_id) as memory_count\\nFROM users u\\nLEFT JOIN relationships r ON u.user_id = r.user_id\\nWHERE u.user_id = ?;\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"leaderboard\",\"children\":[\"$\",\"a\",null,{\"href\":\"#leaderboard\",\"className\":\"anchor-link\",\"children\":\"Leaderboard\"}]}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"sql\",\"children\":\"SELECT user_id, username, bebits,\\n       ROW_NUMBER() OVER (ORDER BY bebits DESC) as rank\\nFROM users\\nORDER BY bebits DESC\\nLIMIT 10;\"}],\"\\n\",[\"$\",\"h3\",null,{\"id\":\"search-memories\",\"children\":[\"$\",\"a\",null,{\"href\":\"#search-memories\",\"className\":\"anchor-link\",\"children\":\"Search Memories\"}]}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"javascript\",\"children\":\"// Semantic search requires application-level processing\\nconst allMemories = db.prepare(`\\n    SELECT * FROM memories\\n    WHERE user_id = ?\\n    ORDER BY importance DESC\\n`).all(userId);\\n\\n// Then compute cosine similarity with query embedding\\nconst relevant = allMemories\\n    .map(m =\u003e ({ ...m, similarity: cosineSimilarity(queryEmbedding, m.embedding) }))\\n    .filter(m =\u003e m.similarity \u003e 0.7)\\n    .sort((a, b) =\u003e b.similarity - a.similarity);\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"migrations\",\"children\":[\"$\",\"a\",null,{\"href\":\"#migrations\",\"className\":\"anchor-link\",\"children\":\"Migrations\"}]}],\"\\n\",[\"$\",\"p\",null,{\"children\":[\"See \",[\"$\",\"a\",null,{\"href\":\"../dev/migrations.md\",\"children\":\"Database Migrations\"}],\" for schema updates.\"]}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"backup\",\"children\":[\"$\",\"a\",null,{\"href\":\"#backup\",\"className\":\"anchor-link\",\"children\":\"Backup\"}]}],\"\\n\",[\"$\",\"$L15\",null,{\"language\":\"bash\",\"children\":\"# Copy database file\\ncp data/beboa.db data/beboa_backup_$(date +%Y%m%d).db\\n\\n# Or use SQLite dump\\nsqlite3 data/beboa.db .dump \u003e backup.sql\"}],\"\\n\",[\"$\",\"h2\",null,{\"id\":\"performance\",\"children\":[\"$\",\"a\",null,{\"href\":\"#performance\",\"className\":\"anchor-link\",\"children\":\"Performance\"}]}],\"\\n\",[\"$\",\"table\",null,{\"children\":[[\"$\",\"thead\",null,{\"children\":[\"$\",\"tr\",null,{\"children\":[[\"$\",\"th\",null,{\"children\":\"Table\"}],[\"$\",\"th\",null,{\"children\":\"Expected Rows\"}],[\"$\",\"th\",null,{\"children\":\"Index Strategy\"}]]}]}],[\"$\",\"tbody\",null,{\"children\":[[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"users\"}],[\"$\",\"td\",null,{\"children\":\"100-10000\"}],[\"$\",\"td\",null,{\"children\":\"bebits, streak\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"memories\"}],[\"$\",\"td\",null,{\"children\":\"1000-100000\"}],[\"$\",\"td\",null,{\"children\":\"user_id, importance\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"chat_history\"}],[\"$\",\"td\",null,{\"children\":\"10000-1M\"}],[\"$\",\"td\",null,{\"children\":\"user_id, timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"admin_log\"}],[\"$\",\"td\",null,{\"children\":\"1000-100000\"}],[\"$\",\"td\",null,{\"children\":\"timestamp\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"server_messages\"}],[\"$\",\"td\",null,{\"children\":\"10000-1M\"}],[\"$\",\"td\",null,{\"children\":\"channel_id+time, author_id\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"server_embeddings\"}],[\"$\",\"td\",null,{\"children\":\"1000-100000\"}],[\"$\",\"td\",null,{\"children\":\"message_id\"}]]}],[\"$\",\"tr\",null,{\"children\":[[\"$\",\"td\",null,{\"children\":\"embedding_queue\"}],[\"$\",\"td\",null,{\"children\":\"0-1000\"}],[\"$\",\"td\",null,{\"children\":\"status+priority\"}]]}]]}]]}],\"\\n\",[\"$\",\"p\",null,{\"children\":\"For large servers (\u003e10k users), consider:\"}],\"\\n\",[\"$\",\"ul\",null,{\"children\":[\"\\n\",[\"$\",\"li\",null,{\"children\":[\"Regular vacuuming: \",[\"$\",\"code\",null,{\"children\":\"VACUUM;\"}]]}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Chat history pruning\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Memory importance decay\"}],\"\\n\",[\"$\",\"li\",null,{\"children\":\"Server message retention (default: 30 days)\"}],\"\\n\"]}]]\n"])</script></body></html>