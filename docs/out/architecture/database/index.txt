3:I[4707,[],""]
5:I[6423,[],""]
6:I[2060,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"ThemeProvider"]
7:I[4351,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"Header"]
8:I[9399,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"Sidebar"]
4:["slug","architecture/database","c"]
0:["FeUt14WxB_Uw-6zJdn3nr",[[["",{"children":[["slug","architecture/database","c"],{"children":["__PAGE__?{\"slug\":[\"architecture\",\"database\"]}",{}]}]},"$undefined","$undefined",true],["",{"children":[["slug","architecture/database","c"],{"children":["__PAGE__",{},[["$L1","$L2",null],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3cf59f0fd0496c15.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_f367f3 __variable_a06722 font-sans","children":["$","$L6",null,{"children":["$","div",null,{"className":"min-h-screen bg-[var(--bg-primary)] transition-colors duration-200","children":[["$","$L7",null,{}],["$","div",null,{"className":"flex","children":[["$","$L8",null,{}],["$","main",null,{"className":"flex-1 min-w-0 lg:pl-[var(--sidebar-width)]","children":["$","div",null,{"className":"max-w-[var(--content-max-width)] mx-auto px-6 py-8 lg:px-8 lg:py-12","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]}]]}]]}]}]}]}]],null],null],["$L9",null]]]]
a:I[6430,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"Breadcrumbs"]
b:I[9078,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"CopyPageButton"]
d:I[3308,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"PageNavigation"]
e:I[5321,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"TableOfContents"]
2:[["$","article",null,{"className":"animate-in","children":[["$","div",null,{"className":"flex items-start justify-between gap-4 mb-6","children":[["$","$La",null,{}],["$","$Lb",null,{}]]}],["$","h1",null,{"children":"Database Schema"}],["$","p",null,{"className":"text-lg text-[var(--text-secondary)] mb-8 -mt-2","children":"Complete SQLite database schema and table documentation."}],["$","div",null,{"className":"prose-custom","children":"$Lc"}],["$","$Ld",null,{}]]}],["$","$Le",null,{}]]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Database Schema - Beboa Docs"}],["$","meta","3",{"name":"description","content":"Complete SQLite database schema and table documentation."}],["$","link","4",{"rel":"icon","href":"/favicon.ico"}],["$","meta","5",{"name":"next-size-adjust"}]]
1:null
f:I[5045,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"CodeBlock"]
c:[["$","h1",null,{"id":"database-schema","children":"Database Schema"}],"\n",["$","p",null,{"children":"Beboa uses SQLite via better-sqlite3 for data persistence."}],"\n",["$","h2",null,{"id":"database-location","children":["$","a",null,{"href":"#database-location","className":"anchor-link","children":"Database Location"}]}],"\n",["$","$Lf",null,{"language":"$undefined","children":"data/beboa.db"}],"\n",["$","p",null,{"children":"Created automatically on first run."}],"\n",["$","h2",null,{"id":"tables","children":["$","a",null,{"href":"#tables","className":"anchor-link","children":"Tables"}]}],"\n",["$","h3",null,{"id":"users","children":["$","a",null,{"href":"#users","className":"anchor-link","children":"users"}]}],"\n",["$","p",null,{"children":"Core user data and engagement stats."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE users (\n    user_id TEXT PRIMARY KEY,\n    username TEXT,\n    bebits INTEGER DEFAULT 0,\n    streak INTEGER DEFAULT 0,\n    longest_streak INTEGER DEFAULT 0,\n    total_checkins INTEGER DEFAULT 0,\n    last_checkin TEXT,\n    created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n    updated_at TEXT DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_users_bebits ON users(bebits DESC);\nCREATE INDEX idx_users_streak ON users(streak DESC);"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Column"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"user_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Discord user ID (PK)"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"username"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Cached username"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"bebits"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Currency balance"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"streak"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Current check-in streak"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"longest_streak"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Best streak ever"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"total_checkins"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Lifetime check-ins"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"last_checkin"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"ISO timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"created_at"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"First interaction"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"updated_at"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Last modification"}]]}]]}]]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"relationships","children":["$","a",null,{"href":"#relationships","className":"anchor-link","children":"relationships"}]}],"\n",["$","p",null,{"children":"Per-user relationship tracking."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE relationships (\n    user_id TEXT PRIMARY KEY,\n    trust_level REAL DEFAULT 10.0,\n    relationship_stage TEXT DEFAULT 'stranger',\n    total_interactions INTEGER DEFAULT 0,\n    positive_interactions INTEGER DEFAULT 0,\n    negative_interactions INTEGER DEFAULT 0,\n    first_interaction TEXT,\n    last_interaction TEXT,\n    notes TEXT,\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\n);"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Column"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"user_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Discord user ID (PK)"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"trust_level"}],["$","td",null,{"children":"REAL"}],["$","td",null,{"children":"0-100 trust score"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"relationship_stage"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"stranger/acquaintance/familiar/friend/close_friend/family"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"total_interactions"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"All interactions"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"positive_interactions"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Pleasant exchanges"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"negative_interactions"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Unpleasant exchanges"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"first_interaction"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"First message timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"last_interaction"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Most recent timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"notes"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Admin notes JSON"}]]}]]}]]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"memories","children":["$","a",null,{"href":"#memories","className":"anchor-link","children":"memories"}]}],"\n",["$","p",null,{"children":"Semantic memory storage with embeddings."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE memories (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id TEXT,\n    content TEXT NOT NULL,\n    memory_type TEXT DEFAULT 'fact',\n    importance REAL DEFAULT 0.5,\n    embedding BLOB,\n    created_at TEXT DEFAULT CURRENT_TIMESTAMP,\n    last_accessed TEXT,\n    access_count INTEGER DEFAULT 0,\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\n);\n\nCREATE INDEX idx_memories_user ON memories(user_id);\nCREATE INDEX idx_memories_type ON memories(memory_type);\nCREATE INDEX idx_memories_importance ON memories(importance DESC);"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Column"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"id"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Auto-increment PK"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"user_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Associated user"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"content"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Memory content"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"memory_type"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"fact/preference/event/relationship/emotional/context"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"importance"}],["$","td",null,{"children":"REAL"}],["$","td",null,{"children":"0.0-1.0 relevance score"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"embedding"}],["$","td",null,{"children":"BLOB"}],["$","td",null,{"children":"1536-dim vector (binary)"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"created_at"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Creation timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"last_accessed"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Last retrieval"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"access_count"}],["$","td",null,{"children":"INTEGER"}],["$","td",null,{"children":"Times retrieved"}]]}]]}]]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"personality","children":["$","a",null,{"href":"#personality","className":"anchor-link","children":"personality"}]}],"\n",["$","p",null,{"children":"Global personality state (single row)."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE personality (\n    id INTEGER PRIMARY KEY DEFAULT 1,\n    openness REAL DEFAULT 0.7,\n    conscientiousness REAL DEFAULT 0.4,\n    extraversion REAL DEFAULT 0.6,\n    agreeableness REAL DEFAULT 0.3,\n    neuroticism REAL DEFAULT 0.5,\n    playfulness REAL DEFAULT 0.8,\n    sarcasm REAL DEFAULT 0.85,\n    protectiveness REAL DEFAULT 0.7,\n    curiosity REAL DEFAULT 0.65,\n    stubbornness REAL DEFAULT 0.75,\n    affection_hidden REAL DEFAULT 0.8,\n    mischief REAL DEFAULT 0.7,\n    drama REAL DEFAULT 0.6,\n    loyalty REAL DEFAULT 0.9,\n    last_updated TEXT\n);"}],"\n",["$","p",null,{"children":"All trait columns are REAL values between 0.0 and 1.0."}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"mood_state","children":["$","a",null,{"href":"#mood_state","className":"anchor-link","children":"mood_state"}]}],"\n",["$","p",null,{"children":"Current mood (single row)."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE mood_state (\n    id INTEGER PRIMARY KEY DEFAULT 1,\n    current_mood TEXT DEFAULT 'neutral',\n    mood_intensity REAL DEFAULT 0.5,\n    last_changed TEXT,\n    trigger_reason TEXT\n);"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Column"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"current_mood"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Active mood name"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"mood_intensity"}],["$","td",null,{"children":"REAL"}],["$","td",null,{"children":"0.0-1.0 strength"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"last_changed"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Change timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"trigger_reason"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"What caused change"}]]}]]}]]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"redemptions","children":["$","a",null,{"href":"#redemptions","className":"anchor-link","children":"redemptions"}]}],"\n",["$","p",null,{"children":"Reward redemption history."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE redemptions (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id TEXT,\n    reward_name TEXT,\n    reward_tier INTEGER,\n    cost INTEGER,\n    redeemed_at TEXT DEFAULT CURRENT_TIMESTAMP,\n    fulfilled INTEGER DEFAULT 0,\n    fulfilled_by TEXT,\n    fulfilled_at TEXT,\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\n);\n\nCREATE INDEX idx_redemptions_user ON redemptions(user_id);\nCREATE INDEX idx_redemptions_fulfilled ON redemptions(fulfilled);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"chat_history","children":["$","a",null,{"href":"#chat_history","className":"anchor-link","children":"chat_history"}]}],"\n",["$","p",null,{"children":"Conversation history per user."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE chat_history (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    user_id TEXT,\n    role TEXT,  -- 'user' or 'assistant'\n    content TEXT,\n    timestamp TEXT DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(user_id)\n);\n\nCREATE INDEX idx_chat_user ON chat_history(user_id);\nCREATE INDEX idx_chat_timestamp ON chat_history(timestamp DESC);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"jarvis_access","children":["$","a",null,{"href":"#jarvis_access","className":"anchor-link","children":"jarvis_access"}]}],"\n",["$","p",null,{"children":"Jarvis Mode permissions."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE jarvis_access (\n    user_id TEXT PRIMARY KEY,\n    granted_by TEXT,\n    granted_at TEXT DEFAULT CURRENT_TIMESTAMP\n);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"admin_log","children":["$","a",null,{"href":"#admin_log","className":"anchor-link","children":"admin_log"}]}],"\n",["$","p",null,{"children":"Admin action audit trail."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE admin_log (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    admin_id TEXT,\n    command TEXT,\n    target_id TEXT,\n    details TEXT,  -- JSON\n    result TEXT,\n    timestamp TEXT DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX idx_admin_log_admin ON admin_log(admin_id);\nCREATE INDEX idx_admin_log_timestamp ON admin_log(timestamp DESC);"}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"server-memory-tables","children":["$","a",null,{"href":"#server-memory-tables","className":"anchor-link","children":"Server Memory Tables"}]}],"\n",["$","p",null,{"children":["These tables power the ",["$","a",null,{"href":"/ai/server-memory","children":"server-wide memory system"}],"."]}],"\n",["$","h3",null,{"id":"server_messages","children":["$","a",null,{"href":"#server_messages","className":"anchor-link","children":"server_messages"}]}],"\n",["$","p",null,{"children":"Raw storage for ALL server messages."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE server_messages (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    message_id TEXT UNIQUE NOT NULL,\n    channel_id TEXT NOT NULL,\n    guild_id TEXT NOT NULL,\n    author_id TEXT NOT NULL,\n    author_name TEXT NOT NULL,\n    content TEXT NOT NULL,\n    content_length INTEGER NOT NULL,\n    has_attachments INTEGER DEFAULT 0,\n    reply_to_id TEXT,\n    importance_score REAL DEFAULT 0.0,\n    embedding_status TEXT DEFAULT 'pending',\n    discord_created_at TEXT NOT NULL,\n    created_at TEXT DEFAULT (datetime('now'))\n);\n\nCREATE INDEX idx_sm_channel ON server_messages(channel_id, discord_created_at DESC);\nCREATE INDEX idx_sm_author ON server_messages(author_id);\nCREATE INDEX idx_sm_time ON server_messages(discord_created_at DESC);\nCREATE INDEX idx_sm_status ON server_messages(embedding_status);\nCREATE INDEX idx_sm_importance ON server_messages(importance_score DESC);"}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Column"}],["$","th",null,{"children":"Type"}],["$","th",null,{"children":"Description"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"message_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Discord message snowflake (unique)"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"channel_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Source channel ID"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"guild_id"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"Server ID"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"importance_score"}],["$","td",null,{"children":"REAL"}],["$","td",null,{"children":"0.0-1.0 importance score"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"embedding_status"}],["$","td",null,{"children":"TEXT"}],["$","td",null,{"children":"pending/embedded/skipped/failed"}]]}]]}]]}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"server_embeddings","children":["$","a",null,{"href":"#server_embeddings","className":"anchor-link","children":"server_embeddings"}]}],"\n",["$","p",null,{"children":"Vectors for important messages."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE server_embeddings (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    message_id INTEGER,\n    summary_id INTEGER,\n    embedding BLOB NOT NULL,\n    source_text TEXT NOT NULL,\n    source_type TEXT DEFAULT 'message',\n    created_at TEXT DEFAULT (datetime('now')),\n    FOREIGN KEY (message_id) REFERENCES server_messages(id),\n    FOREIGN KEY (summary_id) REFERENCES channel_summaries(id)\n);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"channel_summaries","children":["$","a",null,{"href":"#channel_summaries","className":"anchor-link","children":"channel_summaries"}]}],"\n",["$","p",null,{"children":"Periodic channel rollups."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE channel_summaries (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    channel_id TEXT NOT NULL,\n    guild_id TEXT NOT NULL,\n    period_type TEXT NOT NULL,\n    period_start TEXT NOT NULL,\n    period_end TEXT NOT NULL,\n    summary TEXT NOT NULL,\n    key_topics TEXT,\n    key_participants TEXT,\n    message_count INTEGER NOT NULL,\n    created_at TEXT DEFAULT (datetime('now')),\n    UNIQUE(channel_id, period_type, period_start)\n);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"active_topics","children":["$","a",null,{"href":"#active_topics","className":"anchor-link","children":"active_topics"}]}],"\n",["$","p",null,{"children":"Topic lifecycle tracking."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE active_topics (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    guild_id TEXT NOT NULL,\n    topic_name TEXT NOT NULL,\n    mention_count INTEGER DEFAULT 1,\n    status TEXT DEFAULT 'active',\n    last_seen_at TEXT DEFAULT (datetime('now'))\n);"}],"\n",["$","hr",null,{}],"\n",["$","h3",null,{"id":"embedding_queue","children":["$","a",null,{"href":"#embedding_queue","className":"anchor-link","children":"embedding_queue"}]}],"\n",["$","p",null,{"children":"Background processing queue."}],"\n",["$","$Lf",null,{"language":"sql","children":"CREATE TABLE embedding_queue (\n    id INTEGER PRIMARY KEY AUTOINCREMENT,\n    message_id INTEGER NOT NULL,\n    priority INTEGER DEFAULT 0,\n    status TEXT DEFAULT 'pending',\n    retry_count INTEGER DEFAULT 0,\n    error_message TEXT,\n    created_at TEXT DEFAULT (datetime('now')),\n    processed_at TEXT,\n    FOREIGN KEY (message_id) REFERENCES server_messages(id)\n);\n\nCREATE INDEX idx_eq_status ON embedding_queue(status, priority DESC);"}],"\n",["$","hr",null,{}],"\n",["$","h2",null,{"id":"common-queries","children":["$","a",null,{"href":"#common-queries","className":"anchor-link","children":"Common Queries"}]}],"\n",["$","h3",null,{"id":"get-user-with-stats","children":["$","a",null,{"href":"#get-user-with-stats","className":"anchor-link","children":"Get User with Stats"}]}],"\n",["$","$Lf",null,{"language":"sql","children":"SELECT\n    u.*,\n    r.trust_level,\n    r.relationship_stage,\n    (SELECT COUNT(*) FROM memories WHERE user_id = u.user_id) as memory_count\nFROM users u\nLEFT JOIN relationships r ON u.user_id = r.user_id\nWHERE u.user_id = ?;"}],"\n",["$","h3",null,{"id":"leaderboard","children":["$","a",null,{"href":"#leaderboard","className":"anchor-link","children":"Leaderboard"}]}],"\n",["$","$Lf",null,{"language":"sql","children":"SELECT user_id, username, bebits,\n       ROW_NUMBER() OVER (ORDER BY bebits DESC) as rank\nFROM users\nORDER BY bebits DESC\nLIMIT 10;"}],"\n",["$","h3",null,{"id":"search-memories","children":["$","a",null,{"href":"#search-memories","className":"anchor-link","children":"Search Memories"}]}],"\n",["$","$Lf",null,{"language":"javascript","children":"// Semantic search requires application-level processing\nconst allMemories = db.prepare(`\n    SELECT * FROM memories\n    WHERE user_id = ?\n    ORDER BY importance DESC\n`).all(userId);\n\n// Then compute cosine similarity with query embedding\nconst relevant = allMemories\n    .map(m => ({ ...m, similarity: cosineSimilarity(queryEmbedding, m.embedding) }))\n    .filter(m => m.similarity > 0.7)\n    .sort((a, b) => b.similarity - a.similarity);"}],"\n",["$","h2",null,{"id":"migrations","children":["$","a",null,{"href":"#migrations","className":"anchor-link","children":"Migrations"}]}],"\n",["$","p",null,{"children":["See ",["$","a",null,{"href":"../dev/migrations.md","children":"Database Migrations"}]," for schema updates."]}],"\n",["$","h2",null,{"id":"backup","children":["$","a",null,{"href":"#backup","className":"anchor-link","children":"Backup"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Copy database file\ncp data/beboa.db data/beboa_backup_$(date +%Y%m%d).db\n\n# Or use SQLite dump\nsqlite3 data/beboa.db .dump > backup.sql"}],"\n",["$","h2",null,{"id":"performance","children":["$","a",null,{"href":"#performance","className":"anchor-link","children":"Performance"}]}],"\n",["$","table",null,{"children":[["$","thead",null,{"children":["$","tr",null,{"children":[["$","th",null,{"children":"Table"}],["$","th",null,{"children":"Expected Rows"}],["$","th",null,{"children":"Index Strategy"}]]}]}],["$","tbody",null,{"children":[["$","tr",null,{"children":[["$","td",null,{"children":"users"}],["$","td",null,{"children":"100-10000"}],["$","td",null,{"children":"bebits, streak"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"memories"}],["$","td",null,{"children":"1000-100000"}],["$","td",null,{"children":"user_id, importance"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"chat_history"}],["$","td",null,{"children":"10000-1M"}],["$","td",null,{"children":"user_id, timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"admin_log"}],["$","td",null,{"children":"1000-100000"}],["$","td",null,{"children":"timestamp"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"server_messages"}],["$","td",null,{"children":"10000-1M"}],["$","td",null,{"children":"channel_id+time, author_id"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"server_embeddings"}],["$","td",null,{"children":"1000-100000"}],["$","td",null,{"children":"message_id"}]]}],["$","tr",null,{"children":[["$","td",null,{"children":"embedding_queue"}],["$","td",null,{"children":"0-1000"}],["$","td",null,{"children":"status+priority"}]]}]]}]]}],"\n",["$","p",null,{"children":"For large servers (>10k users), consider:"}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":["Regular vacuuming: ",["$","code",null,{"children":"VACUUM;"}]]}],"\n",["$","li",null,{"children":"Chat history pruning"}],"\n",["$","li",null,{"children":"Memory importance decay"}],"\n",["$","li",null,{"children":"Server message retention (default: 30 days)"}],"\n"]}]]
