3:I[4707,[],""]
5:I[6423,[],""]
6:I[2060,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"ThemeProvider"]
7:I[4351,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"Header"]
8:I[9399,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","185","static/chunks/app/layout-4b75b78215e64ea2.js"],"Sidebar"]
4:["slug","deployment/docker","c"]
0:["FeUt14WxB_Uw-6zJdn3nr",[[["",{"children":[["slug","deployment/docker","c"],{"children":["__PAGE__?{\"slug\":[\"deployment\",\"docker\"]}",{}]}]},"$undefined","$undefined",true],["",{"children":[["slug","deployment/docker","c"],{"children":["__PAGE__",{},[["$L1","$L2",null],null],null]},[null,["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children","$4","children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","notFoundStyles":"$undefined"}]],null]},[[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/3cf59f0fd0496c15.css","precedence":"next","crossOrigin":"$undefined"}]],["$","html",null,{"lang":"en","suppressHydrationWarning":true,"children":["$","body",null,{"className":"__variable_f367f3 __variable_a06722 font-sans","children":["$","$L6",null,{"children":["$","div",null,{"className":"min-h-screen bg-[var(--bg-primary)] transition-colors duration-200","children":[["$","$L7",null,{}],["$","div",null,{"className":"flex","children":[["$","$L8",null,{}],["$","main",null,{"className":"flex-1 min-w-0 lg:pl-[var(--sidebar-width)]","children":["$","div",null,{"className":"max-w-[var(--content-max-width)] mx-auto px-6 py-8 lg:px-8 lg:py-12","children":["$","$L3",null,{"parallelRouterKey":"children","segmentPath":["children"],"error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L5",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":"404"}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],"notFoundStyles":[]}]}]}]]}]]}]}]}]}]],null],null],["$L9",null]]]]
a:I[6430,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"Breadcrumbs"]
b:I[9078,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"CopyPageButton"]
d:I[3308,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"PageNavigation"]
e:I[5321,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"TableOfContents"]
2:[["$","article",null,{"className":"animate-in","children":[["$","div",null,{"className":"flex items-start justify-between gap-4 mb-6","children":[["$","$La",null,{}],["$","$Lb",null,{}]]}],["$","h1",null,{"children":"Docker"}],"$undefined",["$","div",null,{"className":"prose-custom","children":"$Lc"}],["$","$Ld",null,{}]]}],["$","$Le",null,{}]]
9:[["$","meta","0",{"name":"viewport","content":"width=device-width, initial-scale=1"}],["$","meta","1",{"charSet":"utf-8"}],["$","title","2",{"children":"Docker - Beboa Docs"}],["$","link","3",{"rel":"icon","href":"/favicon.ico"}],["$","meta","4",{"name":"next-size-adjust"}]]
1:null
f:I[5045,["972","static/chunks/972-68a674eeca97bbbb.js","646","static/chunks/646-1e67c3e800eb58dd.js","877","static/chunks/app/%5B...slug%5D/page-ea4807ff1312ce17.js"],"CodeBlock"]
c:[["$","h1",null,{"id":"docker-deployment","children":"Docker Deployment"}],"\n",["$","p",null,{"children":"Deploy Beboa using Docker for containerized hosting."}],"\n",["$","h2",null,{"id":"prerequisites","children":["$","a",null,{"href":"#prerequisites","className":"anchor-link","children":"Prerequisites"}]}],"\n",["$","ul",null,{"children":["\n",["$","li",null,{"children":"Docker installed"}],"\n",["$","li",null,{"children":"Docker Compose (optional but recommended)"}],"\n",["$","li",null,{"children":"Environment variables ready"}],"\n"]}],"\n",["$","h2",null,{"id":"dockerfile","children":["$","a",null,{"href":"#dockerfile","className":"anchor-link","children":"Dockerfile"}]}],"\n",["$","p",null,{"children":["Create ",["$","code",null,{"children":"Dockerfile"}]," in project root:"]}],"\n",["$","$Lf",null,{"language":"dockerfile","children":"# Build stage\nFROM node:20-alpine AS builder\n\nWORKDIR /app\n\n# Install build dependencies for better-sqlite3\nRUN apk add --no-cache python3 make g++\n\nCOPY package*.json ./\nRUN npm ci --only=production\n\n# Runtime stage\nFROM node:20-alpine\n\nWORKDIR /app\n\n# Install runtime dependencies\nRUN apk add --no-cache sqlite\n\n# Copy from builder\nCOPY --from=builder /app/node_modules ./node_modules\nCOPY . .\n\n# Create data directory\nRUN mkdir -p /app/data\n\n# Set environment\nENV NODE_ENV=production\n\n# Run as non-root user\nRUN addgroup -g 1001 -S nodejs && \\\n    adduser -S beboa -u 1001 -G nodejs && \\\n    chown -R beboa:nodejs /app\n\nUSER beboa\n\nCMD [\"node\", \"src/index.js\"]"}],"\n",["$","h2",null,{"id":"docker-compose","children":["$","a",null,{"href":"#docker-compose","className":"anchor-link","children":"Docker Compose"}]}],"\n",["$","p",null,{"children":["Create ",["$","code",null,{"children":"docker-compose.yml"}],":"]}],"\n",["$","$Lf",null,{"language":"yaml","children":"version: '3.8'\n\nservices:\n  beboa:\n    build: .\n    container_name: beboa-bot\n    restart: unless-stopped\n    volumes:\n      - beboa-data:/app/data\n    env_file:\n      - .env\n    environment:\n      - NODE_ENV=production\n    logging:\n      driver: \"json-file\"\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n\nvolumes:\n  beboa-data:"}],"\n",["$","h2",null,{"id":"building-and-running","children":["$","a",null,{"href":"#building-and-running","className":"anchor-link","children":"Building and Running"}]}],"\n",["$","h3",null,{"id":"with-docker-compose-recommended","children":["$","a",null,{"href":"#with-docker-compose-recommended","className":"anchor-link","children":"With Docker Compose (Recommended)"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Build and start\ndocker compose up -d --build\n\n# View logs\ndocker compose logs -f\n\n# Stop\ndocker compose down\n\n# Restart\ndocker compose restart"}],"\n",["$","h3",null,{"id":"with-docker-only","children":["$","a",null,{"href":"#with-docker-only","className":"anchor-link","children":"With Docker Only"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Build image\ndocker build -t beboa-bot .\n\n# Create volume for data\ndocker volume create beboa-data\n\n# Run container\ndocker run -d \\\n  --name beboa-bot \\\n  --restart unless-stopped \\\n  -v beboa-data:/app/data \\\n  --env-file .env \\\n  beboa-bot\n\n# View logs\ndocker logs -f beboa-bot"}],"\n",["$","h2",null,{"id":"environment-variables","children":["$","a",null,{"href":"#environment-variables","className":"anchor-link","children":"Environment Variables"}]}],"\n",["$","h3",null,{"id":"using-env-file","children":["$","a",null,{"href":"#using-env-file","className":"anchor-link","children":"Using .env File"}]}],"\n",["$","p",null,{"children":["Create ",["$","code",null,{"children":".env"}]," in project root (not committed to git):"]}],"\n",["$","$Lf",null,{"language":"env","children":"DISCORD_TOKEN=your_token\nCLIENT_ID=your_client_id\nGUILD_ID=your_guild_id\nCHECKIN_CHANNEL_ID=your_channel\nNOTIFICATION_CHANNEL_ID=your_channel\nADMIN_ROLE_ID=your_role\nOPENROUTER_API_KEY=your_key\nBEBE_USER_ID=your_id\n\nOPENROUTER_MODEL=deepseek/deepseek-chat\nCHAT_ENABLED=true\nMEMORY_ENABLED=true"}],"\n",["$","h3",null,{"id":"using-docker-secrets-production","children":["$","a",null,{"href":"#using-docker-secrets-production","className":"anchor-link","children":"Using Docker Secrets (Production)"}]}],"\n",["$","$Lf",null,{"language":"yaml","children":"# docker-compose.yml\nversion: '3.8'\n\nservices:\n  beboa:\n    build: .\n    secrets:\n      - discord_token\n      - openrouter_key\n    environment:\n      - DISCORD_TOKEN_FILE=/run/secrets/discord_token\n      - OPENROUTER_API_KEY_FILE=/run/secrets/openrouter_key\n\nsecrets:\n  discord_token:\n    file: ./secrets/discord_token.txt\n  openrouter_key:\n    file: ./secrets/openrouter_key.txt"}],"\n",["$","h2",null,{"id":"multi-stage-considerations","children":["$","a",null,{"href":"#multi-stage-considerations","className":"anchor-link","children":"Multi-Stage Considerations"}]}],"\n",["$","h3",null,{"id":"development-vs-production","children":["$","a",null,{"href":"#development-vs-production","className":"anchor-link","children":"Development vs Production"}]}],"\n",["$","$Lf",null,{"language":"yaml","children":"# docker-compose.yml\nversion: '3.8'\n\nservices:\n  beboa:\n    build:\n      context: .\n      target: ${BUILD_TARGET:-production}\n    volumes:\n      - beboa-data:/app/data\n      # Dev only: mount source for hot reload\n      - ${DEV_MOUNT:-/dev/null}:/app/src:ro\n\nvolumes:\n  beboa-data:"}],"\n",["$","h3",null,{"id":"development-docker-compose-override","children":["$","a",null,{"href":"#development-docker-compose-override","className":"anchor-link","children":"Development Docker Compose Override"}]}],"\n",["$","p",null,{"children":["Create ",["$","code",null,{"children":"docker-compose.override.yml"}],":"]}],"\n",["$","$Lf",null,{"language":"yaml","children":"version: '3.8'\n\nservices:\n  beboa:\n    build:\n      target: development\n    volumes:\n      - .:/app\n      - /app/node_modules\n    command: npm run dev"}],"\n",["$","h2",null,{"id":"health-checks","children":["$","a",null,{"href":"#health-checks","className":"anchor-link","children":"Health Checks"}]}],"\n",["$","p",null,{"children":"Add health check to Dockerfile:"}],"\n",["$","$Lf",null,{"language":"dockerfile","children":"HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\n  CMD node -e \"require('http').get('http://localhost:3000/health', (r) => process.exit(r.statusCode === 200 ? 0 : 1))\""}],"\n",["$","p",null,{"children":"Or in docker-compose:"}],"\n",["$","$Lf",null,{"language":"yaml","children":"services:\n  beboa:\n    healthcheck:\n      test: [\"CMD\", \"node\", \"-e\", \"console.log('healthy')\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 10s"}],"\n",["$","h2",null,{"id":"updating","children":["$","a",null,{"href":"#updating","className":"anchor-link","children":"Updating"}]}],"\n",["$","h3",null,{"id":"rebuild-and-restart","children":["$","a",null,{"href":"#rebuild-and-restart","className":"anchor-link","children":"Rebuild and Restart"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Pull latest code\ngit pull\n\n# Rebuild and restart\ndocker compose up -d --build"}],"\n",["$","h3",null,{"id":"zero-downtime-update-advanced","children":["$","a",null,{"href":"#zero-downtime-update-advanced","className":"anchor-link","children":"Zero-Downtime Update (Advanced)"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Build new image\ndocker compose build\n\n# Scale up new container\ndocker compose up -d --scale beboa=2 --no-recreate\n\n# Wait for new container to be healthy\nsleep 30\n\n# Remove old container\ndocker compose up -d --scale beboa=1"}],"\n",["$","h2",null,{"id":"backup-and-restore","children":["$","a",null,{"href":"#backup-and-restore","className":"anchor-link","children":"Backup and Restore"}]}],"\n",["$","h3",null,{"id":"backup-data-volume","children":["$","a",null,{"href":"#backup-data-volume","className":"anchor-link","children":"Backup Data Volume"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Backup\ndocker run --rm \\\n  -v beboa-data:/data \\\n  -v $(pwd)/backups:/backup \\\n  alpine tar czf /backup/beboa-backup-$(date +%Y%m%d).tar.gz -C /data .\n\n# Restore\ndocker run --rm \\\n  -v beboa-data:/data \\\n  -v $(pwd)/backups:/backup \\\n  alpine tar xzf /backup/beboa-backup-20240115.tar.gz -C /data"}],"\n",["$","h3",null,{"id":"automated-backup","children":["$","a",null,{"href":"#automated-backup","className":"anchor-link","children":"Automated Backup"}]}],"\n",["$","p",null,{"children":["Create ",["$","code",null,{"children":"backup-cron.sh"}],":"]}],"\n",["$","$Lf",null,{"language":"bash","children":"#!/bin/bash\ndocker run --rm \\\n  -v beboa-data:/data \\\n  -v /backups:/backup \\\n  alpine tar czf /backup/beboa-$(date +%Y%m%d_%H%M%S).tar.gz -C /data .\n\n# Keep only last 7 days\nfind /backups -name \"beboa-*.tar.gz\" -mtime +7 -delete"}],"\n",["$","p",null,{"children":"Add to crontab:"}],"\n",["$","$Lf",null,{"language":"bash","children":"0 0 * * * /path/to/backup-cron.sh"}],"\n",["$","h2",null,{"id":"resource-limits","children":["$","a",null,{"href":"#resource-limits","className":"anchor-link","children":"Resource Limits"}]}],"\n",["$","$Lf",null,{"language":"yaml","children":"# docker-compose.yml\nservices:\n  beboa:\n    deploy:\n      resources:\n        limits:\n          cpus: '0.5'\n          memory: 512M\n        reservations:\n          cpus: '0.25'\n          memory: 256M"}],"\n",["$","h2",null,{"id":"logging","children":["$","a",null,{"href":"#logging","className":"anchor-link","children":"Logging"}]}],"\n",["$","h3",null,{"id":"view-logs","children":["$","a",null,{"href":"#view-logs","className":"anchor-link","children":"View Logs"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# All logs\ndocker compose logs\n\n# Follow logs\ndocker compose logs -f\n\n# Last 100 lines\ndocker compose logs --tail=100"}],"\n",["$","h3",null,{"id":"log-rotation","children":["$","a",null,{"href":"#log-rotation","className":"anchor-link","children":"Log Rotation"}]}],"\n",["$","p",null,{"children":"Already configured in docker-compose.yml:"}],"\n",["$","$Lf",null,{"language":"yaml","children":"logging:\n  driver: \"json-file\"\n  options:\n    max-size: \"10m\"\n    max-file: \"3\""}],"\n",["$","h2",null,{"id":"troubleshooting","children":["$","a",null,{"href":"#troubleshooting","className":"anchor-link","children":"Troubleshooting"}]}],"\n",["$","h3",null,{"id":"container-wont-start","children":["$","a",null,{"href":"#container-wont-start","className":"anchor-link","children":"Container Won't Start"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Check logs\ndocker compose logs beboa\n\n# Check container status\ndocker ps -a\n\n# Inspect container\ndocker inspect beboa-bot"}],"\n",["$","h3",null,{"id":"volume-issues","children":["$","a",null,{"href":"#volume-issues","className":"anchor-link","children":"Volume Issues"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# List volumes\ndocker volume ls\n\n# Inspect volume\ndocker volume inspect beboa-data\n\n# Remove and recreate (WARNING: deletes data)\ndocker compose down -v\ndocker compose up -d"}],"\n",["$","h3",null,{"id":"permission-issues","children":["$","a",null,{"href":"#permission-issues","className":"anchor-link","children":"Permission Issues"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Fix volume permissions\ndocker run --rm \\\n  -v beboa-data:/data \\\n  alpine chown -R 1001:1001 /data"}],"\n",["$","h3",null,{"id":"network-issues","children":["$","a",null,{"href":"#network-issues","className":"anchor-link","children":"Network Issues"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Check network\ndocker network ls\ndocker network inspect beboa_default"}],"\n",["$","h2",null,{"id":"cloud-deployment","children":["$","a",null,{"href":"#cloud-deployment","className":"anchor-link","children":"Cloud Deployment"}]}],"\n",["$","h3",null,{"id":"aws-ecs","children":["$","a",null,{"href":"#aws-ecs","className":"anchor-link","children":"AWS ECS"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Push to ECR\naws ecr get-login-password | docker login --username AWS --password-stdin <account>.dkr.ecr.<region>.amazonaws.com\ndocker tag beboa-bot:latest <account>.dkr.ecr.<region>.amazonaws.com/beboa:latest\ndocker push <account>.dkr.ecr.<region>.amazonaws.com/beboa:latest"}],"\n",["$","h3",null,{"id":"google-cloud-run","children":["$","a",null,{"href":"#google-cloud-run","className":"anchor-link","children":"Google Cloud Run"}]}],"\n",["$","$Lf",null,{"language":"bash","children":"# Push to GCR\ngcloud auth configure-docker\ndocker tag beboa-bot gcr.io/<project>/beboa\ndocker push gcr.io/<project>/beboa\n\n# Deploy\ngcloud run deploy beboa --image gcr.io/<project>/beboa"}],"\n",["$","h3",null,{"id":"digitalocean-app-platform","children":["$","a",null,{"href":"#digitalocean-app-platform","className":"anchor-link","children":"DigitalOcean App Platform"}]}],"\n",["$","ol",null,{"children":["\n",["$","li",null,{"children":"Push image to registry"}],"\n",["$","li",null,{"children":"Create App in DigitalOcean"}],"\n",["$","li",null,{"children":"Select Docker image"}],"\n",["$","li",null,{"children":"Configure environment variables"}],"\n",["$","li",null,{"children":"Deploy"}],"\n"]}]]
